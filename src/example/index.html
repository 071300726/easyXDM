<!doctype html>
<html>
    <head>
        <title>easyXSS</title>
        <script type="text/javascript" src="../easyXSS.debug.js">
        </script>
        <script type="text/javascript">
            easyXSS.DomHelper.requiresJSON("../json2.js");
        </script>
        <script type="text/javascript">
            /* This window will create a proxy to different domain.
             * The remote side of the proxy can be used to run XHR-requests or can open
             * a window with window.open so that the user has two windows from two domains
             * that are able to communicate.
             */
            var proxy;
            window.onload = function(){
                proxy = easyXSS.createChannel({
                    onData: function(data, origin){
                        var div = document.createElement("div");
                        div.innerHTML = "data from '" + origin + "'";
                        document.body.appendChild(div);
                        for (key in data) {
                            var div = document.createElement("div");
                            div.innerHTML = key + "=" + data[key];
                            document.body.appendChild(div);
                        }
                    },
                    converter: JSON,
                    local: "/hash.html",
                    remote: "http://provider.easyxss.net/example/remote.html"
                });
            }
        </script>
    </head>
    <body>
		<div id="log" style="height:100px;border:1px dotted black;overflow:auto"></div>
        <input type="button" onclick="proxy.sendData({a:'b',c:'d',e:'f'});" value="send data to remote"/>
    </body>
</html>