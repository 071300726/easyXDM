<!doctype html>
<html>
    <head>
        <title>easyXSS</title>
        <script type="text/javascript" src="../easyXSS.debug.js">
        </script>
        <script type="text/javascript">
            easyXSS.DomHelper.requiresJSON("../json2.js");
        </script>
        <script type="text/javascript">
            var channel, remote;
            window.onload = function(){
                channel = easyXSS.createChannel({
                    onReady: function(){
                        remote = easyXSS.createInterface(channel, {
                            remote: {
                                alertMessage: {
                                    isVoid: true
                                }
                            },
                            local: {
                                addNumbers: {
                                    method: function(a, b){
                                        _log("method addNumbers called");
                                        return a + b;
                                    }
                                },
                                multiplyNumbers: {
                                    isAsync: true,
                                    method: function(a, b, fn){
                                        _log("method multiplyNumbers called");
                                        window.setTimeout(function(){
                                            _log("returning multiplyNumbers");
                                            fn(a * b);
                                        }, 5000);
                                    }
                                },
                                noOp: {
                                    isVoid: true,
                                    method: function(){
                                        _log("method noOp called");
                                        alert("Method not returning any data");
                                    }
                                }
                            }
                        });
                    }
                });
            }
            function _log(msg){
                var div = document.createElement("div");
                div.innerHTML = msg;
                document.body.appendChild(div);
            }
        </script>
    </head>
    <body>
        <script type="text/javascript">
            document.write("Domain: " + location.host);
        </script>
        <br/>
        <input type="button" onclick="remote.alertMessage('message from remote');" value="call alertMessage on local domain"/>
    </body>
</html>